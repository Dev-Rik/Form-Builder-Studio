<div class="properties-panel">
  <h2>Properties</h2>

  @if (selectedField(); as field) {
  <div class="properties-content">
    <div class="property-group">
      <label>Label</label>
      <input
        type="text"
        [value]="field.label"
        (input)="updateLabel($event)"
        class="property-input"
      />
    </div>

    <div class="property-group">
      <label>Placeholder</label>
      <input
        type="text"
        [value]="field.placeholder || ''"
        (input)="updatePlaceholder($event)"
        class="property-input"
      />
    </div>

    <div class="property-group checkbox-group">
      <input
        type="checkbox"
        [checked]="field.required"
        (change)="updateRequired($event)"
        id="required-checkbox"
      />
      <label for="required-checkbox">Required</label>
    </div>

    @if (hasOptions()) {
    <div class="property-group">
      <label>Options</label>
      @for (opt of field.options; track i; let i = $index) {
      <div class="option-item">
        <input
          type="text"
          [value]="opt"
          (input)="updateOption(i, $event)"
          class="property-input"
        />
        <button class="remove-btn" (click)="removeOption(i)">Ã—</button>
      </div>
      }
      <button class="add-option-btn" (click)="addOption()">+ Add Option</button>
    </div>
    }

    <div class="property-group">
      <label>Validation</label>
      <div class="validation-inputs">
        @if (field.type === 'text') {
        <input
          type="number"
          placeholder="Min Length"
          [value]="field.validation?.minLength || ''"
          (input)="updateValidation('minLength', $event)"
          class="property-input"
        />
        <input
          type="number"
          placeholder="Max Length"
          [value]="field.validation?.maxLength || ''"
          (input)="updateValidation('maxLength', $event)"
          class="property-input"
        />
        }
        <input
          type="text"
          placeholder="Regex Pattern"
          [value]="field.validation?.pattern || ''"
          (input)="updateValidation('pattern', $event)"
          class="property-input"
        />
      </div>
    </div>

    <div class="property-group">
      <label>Conditional</label>
      <div class="conditional-inputs">
        <label class="sub-label">Show if</label>
        <select
          [value]="field.conditional?.field || ''"
          (change)="updateConditionalField($event)"
          class="property-input"
        >
          <option value="">None</option>
          @for (otherField of otherFields(); track otherField.id) {
          <option [value]="otherField.id">
            {{ otherField.label }}
          </option>
          }
        </select>

        @if (field.conditional?.show) {
        <label class="sub-label">is</label>
        <select
          [value]="field.conditional?.operator || 'equals'"
          (change)="updateConditionalOperator($event)"
          class="property-input"
        >
          <option value="equals">equals</option>
          <option value="notEquals">not equals</option>
          <option value="contains">contains</option>
        </select>

        <input
          type="text"
          placeholder="Value"
          [value]="field.conditional?.value || ''"
          (input)="updateConditionalValue($event)"
          class="property-input"
        />
        }
      </div>
    </div>
  </div>
  } @else {
  <p class="no-selection">Select a field to edit its properties</p>
  }
</div>
